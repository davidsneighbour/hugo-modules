{{- /*
	Input is expected to be a CSS-style hex color string (e.g. #RRGGBB).
	Output is the luminance from 0 to 1.

	Luminance = sqrt( 0.299*R^2 + 0.587*G^2 + 0.114*B^2 )

	See: https://alienryderflex.com/hsp.html
	     https://stackoverflow.com/questions/596216/formula-to-determine-perceived-brightness-of-rgb-color
		   https://gohugo.io/methods/resource/colors/
*/ -}}

{{- $r := (printf "0x%s" (substr . 1 2)) | int -}}
{{- $g := (printf "0x%s" (substr . 3 2)) | int -}}
{{- $b := (printf "0x%s" (substr . 5 2)) | int -}}

{{- $r_norm := div $r 255.0 -}}
{{- $g_norm := div $g 255.0 -}}
{{- $b_norm := div $b 255.0 -}}

{{- return (math.Sqrt (add
          (pow $r_norm 2 | mul 0.299)
          (pow $g_norm 2 | mul 0.587)
          (pow $b_norm 2 | mul 0.114)
)) -}}
