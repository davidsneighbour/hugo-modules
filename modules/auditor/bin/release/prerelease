#!/bin/bash
# v2023.11.16.02

source ./common

set -e

check_required_tools curl sed git
load_env_vars .env

# Get the current path
CURPATH="$(pwd -P)"

# Build assets in static folder and add to commit if it exists
if [ -d "static" ]; then
  npm run build
  git add static
fi

# Update Hugo modules and add changes to repository
hugo mod get -u ./...
hugo mod tidy
git add "${CURPATH}/go.mod"
FILE="${CURPATH}/go.sum"
if [ -f "$FILE" ]; then
  git add "$FILE"
fi
